on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
jobs:
  test:
    runs-on: self-hosted
    steps:
      - name:
        uses: actions/checkout@v4

      - name: run python test
        run: |
          echo "running python tests ...."
          python3 test_calculator.py -v
          echo "all tests done!"
      
      - name: run the python application
        run: |
          echo "running the application ...."
          python3 calculator.py
          echo " application is running!"
  build:
    runs-on: self-hosted
    needs: test
    steps:
      - name: build image from python.py
        run: |
          echo " removing the lastest version of image ..."
          docker image rm calculator
          echo "building a new image from python.py ..."
          docker build -t calculator .
          docker image ls
          echo "image is built!"




